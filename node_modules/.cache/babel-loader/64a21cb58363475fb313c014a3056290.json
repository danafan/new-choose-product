{"remainingRequest":"/Users/fanyulong/project/2022/new-choose-product/node_modules/babel-loader/lib/index.js!/Users/fanyulong/project/2022/new-choose-product/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/fanyulong/project/2022/new-choose-product/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fanyulong/project/2022/new-choose-product/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fanyulong/project/2022/new-choose-product/src/App.vue","mtime":1687425889873},{"path":"/Users/fanyulong/project/2022/new-choose-product/babel.config.js","mtime":1662529345000},{"path":"/Users/fanyulong/project/2022/new-choose-product/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fanyulong/project/2022/new-choose-product/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/fanyulong/project/2022/new-choose-product/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fanyulong/project/2022/new-choose-product/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.function.name\";\nimport resource from \"./api/resource.js\";\nimport * as dd from 'dingtalk-jsapi';\nexport default {\n  created: function created() {\n    this.getUserInfo();\n    return;\n    var user_type = sessionStorage.getItem(\"user_type\");\n\n    if (user_type != '2') {\n      //内部\n      if (dd.env.platform != 'notInDingTalk') {\n        //是钉钉环境\n        //获取code\n        this.getCode();\n      } else {\n        //不是钉钉环境\n        this.getUserInfo();\n      }\n    }\n  },\n  watch: {\n    $route: function $route(n, o) {\n      document.title = n.name;\n    }\n  },\n  methods: {\n    //获取code\n    getCode: function getCode() {\n      var _this = this;\n\n      dd.ready(function () {\n        dd.runtime.permission.requestAuthCode({\n          corpId: \"ding7828fff434921f5b\",\n          onSuccess: function onSuccess(res) {\n            //获取钉钉用户信息\n            var code = res.code;\n\n            _this.GetDingUserInfo(code);\n          },\n          onFail: function onFail(err) {\n            alert('dd error: ' + JSON.stringify(err));\n          }\n        });\n      });\n    },\n    //钉钉获取用户信息\n    GetDingUserInfo: function GetDingUserInfo(code) {\n      var _this2 = this;\n\n      resource.dingLogin({\n        code: code\n      }).then(function (res) {\n        if (res.data.code == 1) {\n          _this2.getUserInfo();\n        } else {\n          _this2.$message.warning(res.data.msg);\n        }\n      });\n    },\n    //获取用户信息\n    getUserInfo: function getUserInfo() {\n      var _this3 = this;\n\n      resource.getUserInfo().then(function (res) {\n        if (res.data.code == 1) {\n          sessionStorage.setItem(\"cache\", true);\n          var data = res.data.data;\n          sessionStorage.setItem(\"user_type\", data.user_type);\n          sessionStorage.setItem(\"ding_user_id\", data.ding_user_id);\n          sessionStorage.setItem(\"ding_user_name\", data.ding_user_name);\n          sessionStorage.setItem(\"secret_key\", data.secret_key);\n          sessionStorage.setItem(\"login_token\", data.login_token);\n          var user_info = {\n            user_type: data.user_type,\n            ding_user_id: data.ding_user_id,\n            ding_user_name: data.ding_user_name,\n            login_token: data.login_token,\n            secret_key: data.secret_key\n          };\n\n          _this3.$store.commit('setToken', user_info);\n\n          var domain = data.img_domain;\n\n          _this3.$store.commit('setDomain', domain);\n\n          sessionStorage.setItem(\"domain\", domain); //获取导航\n\n          _this3.getMenuNotice();\n        } else {\n          _this3.$message.warning(res.data.msg);\n        }\n      });\n    },\n    //获取导航\n    getMenuNotice: function getMenuNotice() {\n      var _this4 = this;\n\n      resource.getMenuNotice().then(function (res) {\n        if (res.data.code == 1) {\n          var data = res.data.data;\n          var menu_list = data.menu_list;\n\n          _this4.$store.commit(\"setMenuList\", menu_list);\n\n          sessionStorage.setItem(\"menu_list\", JSON.stringify(menu_list));\n\n          if (window.location.hash.split('#/')[1] == '') {\n            _this4.$router.replace('/tab_menu');\n          }\n        } else {\n          _this4.$message.warning(res.data.msg);\n        }\n      });\n    }\n  }\n};",{"version":3,"mappings":";;;AAMA;AACA;AACA;EACAA,OADA,qBACA;IAEA;IACA;IAEA;;IACA;MAAA;MACA;QAAA;QACA;QACA;MACA,CAHA,MAGA;QAAA;QACA;MACA;IACA;EACA,CAfA;EAgBAC;IACAC;MACAC;IACA;EAHA,CAhBA;EAqBAC;IACA;IACAC,OAFA,qBAEA;MAAA;;MACAC;QACAA;UACAC,8BADA;UAEAC;YACA;YACA;;YACA;UACA,CANA;UAOAC;YACAC;UACA;QATA;MAWA,CAZA;IAaA,CAhBA;IAiBA;IACAC,eAlBA,2BAkBAC,IAlBA,EAkBA;MAAA;;MACAC;QAAAD;MAAA;QACA;UACA;QACA,CAFA,MAEA;UACA;QACA;MACA,CANA;IAOA,CA1BA;IA2BA;IACAE,WA5BA,yBA4BA;MAAA;;MACAD;QACA;UACAE;UACA;UACAA;UACAA;UACAA;UACAA;UACAA;UACA;YACAC,yBADA;YAEAC,+BAFA;YAGAC,mCAHA;YAIAC,6BAJA;YAKAC;UALA;;UAOA;;UACA;;UACA;;UACAL,yCAlBA,CAmBA;;UACA;QACA,CArBA,MAqBA;UACA;QACA;MACA,CAzBA;IA0BA,CAvDA;IAwDA;IACAM,aAzDA,2BAyDA;MAAA;;MACAR;QACA;UACA;UACA;;UAEA;;UACAE;;UACA;YACA;UACA;QACA,CATA,MASA;UACA;QACA;MACA,CAbA;IAcA;EAxEA;AArBA","names":["created","watch","$route","document","methods","getCode","dd","corpId","onSuccess","onFail","alert","GetDingUserInfo","code","resource","getUserInfo","sessionStorage","user_type","ding_user_id","ding_user_name","login_token","secret_key","getMenuNotice"],"sourceRoot":"src","sources":["App.vue"],"sourcesContent":["<template>\n  <div id=\"app\">\n    <router-view></router-view>\n  </div>\n</template>\n<script>\n  import resource from './api/resource.js'\n  import * as dd from 'dingtalk-jsapi';\n  export default {\n    created() {\n\n      this.getUserInfo();\n      return;\n\n      let user_type = sessionStorage.getItem(\"user_type\");\n      if(user_type != '2'){ //内部\n        if(dd.env.platform != 'notInDingTalk'){ //是钉钉环境\n          //获取code\n          this.getCode();\n        }else{                                  //不是钉钉环境\n          this.getUserInfo();\n        }\n      }\n    },\n    watch:{\n      $route:function(n,o){\n        document.title = n.name;\n      }\n    },\n    methods: {\n        //获取code\n      getCode(){\n        dd.ready(() => {\n          dd.runtime.permission.requestAuthCode({\n            corpId: \"ding7828fff434921f5b\",\n            onSuccess: res =>{\n                      //获取钉钉用户信息\n              let code = res.code;\n              this.GetDingUserInfo(code);\n            },\n            onFail : err => {\n              alert('dd error: ' + JSON.stringify(err));\n            }\n          });\n        });\n      },\n          //钉钉获取用户信息\n      GetDingUserInfo(code){\n        resource.dingLogin({code:code}).then(res => {\n          if(res.data.code == 1){\n            this.getUserInfo();\n          }else{\n            this.$message.warning(res.data.msg);\n          }\n        })\n      },\n        //获取用户信息\n      getUserInfo() {\n        resource.getUserInfo().then((res) => {\n          if (res.data.code == 1) {\n            sessionStorage.setItem(\"cache\",true);\n            let data = res.data.data;\n            sessionStorage.setItem(\"user_type\", data.user_type);\n            sessionStorage.setItem(\"ding_user_id\", data.ding_user_id);\n            sessionStorage.setItem(\"ding_user_name\", data.ding_user_name);\n            sessionStorage.setItem(\"secret_key\", data.secret_key);\n            sessionStorage.setItem(\"login_token\", data.login_token);\n            let user_info = {\n              user_type:data.user_type,\n              ding_user_id:data.ding_user_id,\n              ding_user_name:data.ding_user_name,\n              login_token:data.login_token,\n              secret_key:data.secret_key\n            }\n            this.$store.commit('setToken',user_info);\n            let domain = data.img_domain;\n            this.$store.commit('setDomain',domain);\n            sessionStorage.setItem(\"domain\",domain);\n              //获取导航\n            this.getMenuNotice();\n          } else {\n            this.$message.warning(res.data.msg);\n          }\n        });\n      },\n        //获取导航\n      getMenuNotice(){\n        resource.getMenuNotice().then(res => {\n          if(res.data.code == 1){\n            let data = res.data.data;\n            let menu_list = data.menu_list;\n\n            this.$store.commit(\"setMenuList\", menu_list);\n            sessionStorage.setItem(\"menu_list\",JSON.stringify(menu_list))\n            if(window.location.hash.split('#/')[1] == ''){\n              this.$router.replace('/tab_menu')\n            }\n          }else{\n            this.$message.warning(res.data.msg);\n          }\n        })\n      },\n    },\n  };\n</script>"]}]}