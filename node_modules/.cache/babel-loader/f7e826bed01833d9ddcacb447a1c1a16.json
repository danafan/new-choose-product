{"remainingRequest":"/Users/fanyulong/project/2022/new-choose-product/node_modules/thread-loader/dist/cjs.js!/Users/fanyulong/project/2022/new-choose-product/node_modules/babel-loader/lib/index.js!/Users/fanyulong/project/2022/new-choose-product/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/fanyulong/project/2022/new-choose-product/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fanyulong/project/2022/new-choose-product/src/components/upload_file.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fanyulong/project/2022/new-choose-product/src/components/upload_file.vue","mtime":1686819444768},{"path":"/Users/fanyulong/project/2022/new-choose-product/babel.config.js","mtime":1662529345000},{"path":"/Users/fanyulong/project/2022/new-choose-product/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fanyulong/project/2022/new-choose-product/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fanyulong/project/2022/new-choose-product/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/fanyulong/project/2022/new-choose-product/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fanyulong/project/2022/new-choose-product/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\nimport draggable from \"vuedraggable\";\nimport resource from \"../api/common_resource.js\";\nexport default {\n  data: function data() {\n    return {\n      preview_images: [] //当前的图片列表\n\n    };\n  },\n  computed: {\n    //图片前缀\n    domain: function domain() {\n      return this.$store.state.domain;\n    }\n  },\n  props: {\n    img_list: {\n      type: Array,\n      default: []\n    },\n    //是否多选\n    is_multiple: {\n      type: Boolean,\n      default: false\n    },\n    //多选已上传的数量\n    current_num: {\n      type: Number,\n      default: 0\n    },\n    //多选最多上传的数量\n    max_num: {\n      type: Number,\n      default: 1\n    },\n    //尺寸\n    size: {\n      type: Number,\n      default: 120\n    },\n    //是否可以设置主图\n    is_main: {\n      type: Boolean,\n      default: false\n    }\n  },\n  created: function created() {\n    this.preview_images = this.img_list;\n  },\n  methods: {\n    //置顶\n    toFirst: function toFirst(index) {\n      this.preview_images.unshift(this.preview_images.splice(index, 1)[0]); //向父组件传递已选的图片列表\n\n      this.emitFn();\n      this.preview_images[0]['show_icon'] = false;\n    },\n    // 上传图片\n    uploadFn: function uploadFn() {\n      var _this = this;\n\n      if (this.$refs.imgUpload.files.length > 0) {\n        var files = this.$refs.imgUpload.files; //判断是否多选\n\n        if (this.is_multiple == true) {\n          if (this.current_num + this.$refs.imgUpload.files.length > this.max_num) {\n            this.$refs.imgUpload.value = null;\n            this.$message.warning(\"\\u56FE\\u7247\\u6700\\u591A\\u4E0D\\u8D85\\u8FC7\".concat(this.max_num, \"\\u5F20\"));\n            return;\n          }\n        }\n\n        for (var i = 0; i < files.length; i++) {\n          var arg = {\n            file: files[i]\n          };\n          resource.uploadFile(arg).then(function (res) {\n            _this.$refs.imgUpload.value = null;\n\n            if (res.data.code == 1) {\n              var file = res.data.data;\n              file.show_icon = false;\n\n              _this.preview_images.push(file); //向父组件传递已选的图片列表\n\n\n              _this.emitFn();\n            } else {\n              _this.$message.warning(res.data.msg);\n            }\n          });\n        }\n      }\n    },\n    //删除文件\n    deleteFile: function deleteFile(url, index) {\n      var _this2 = this;\n\n      var arg = {\n        url: url\n      };\n      resource.delFile(arg).then(function (res) {\n        if (res.data.code == 1) {\n          _this2.preview_images.splice(index, 1); //向父组件传递已选的图片列表\n\n\n          _this2.emitFn();\n        } else {\n          _this2.$message.warning(res.data.msg);\n        }\n      });\n    },\n    //向父组件传递已选的图片列表\n    emitFn: function emitFn() {\n      var image_arr = [];\n      this.preview_images.map(function (item) {\n        image_arr.push(item.urls);\n      });\n      this.$emit('callbackFn', image_arr);\n    }\n  },\n  components: {\n    draggable: draggable\n  }\n};",{"version":3,"mappings":";AA8FA;AAEA;AACA;EACAA,IADA,kBACA;IACA;MACAC,kBADA,CACA;;IADA;EAGA,CALA;EAMAC;IACA;IACAC,MAFA,oBAEA;MACA;IACA;EAJA,CANA;EAYAC;IACAC;MACAC,WADA;MAEAC;IAFA,CADA;IAKA;IACAC;MACAF,aADA;MAEAC;IAFA,CANA;IAUA;IACAE;MACAH,YADA;MAEAC;IAFA,CAXA;IAeA;IACAG;MACAJ,YADA;MAEAC;IAFA,CAhBA;IAoBA;IACAI;MACAL,YADA;MAEAC;IAFA,CArBA;IAyBA;IACAK;MACAN,aADA;MAEAC;IAFA;EA1BA,CAZA;EA2CAM,OA3CA,qBA2CA;IACA;EACA,CA7CA;EA8CAC;IACA;IACAC,OAFA,mBAEAC,KAFA,EAEA;MACA,qEADA,CAEA;;MACA;MACA;IACA,CAPA;IAQA;IACAC,QATA,sBASA;MAAA;;MACA;QACA,uCADA,CAEA;;QACA;UACA;YACA;YACA;YACA;UACA;QACA;;QACA;UACA;YACAC;UADA;UAGAC;YACA;;YACA;cACA;cACAD;;cACA,gCAHA,CAIA;;;cACA;YACA,CANA,MAMA;cACA;YACA;UACA,CAXA;QAYA;MACA;IACA,CAtCA;IAuCA;IACAE,UAxCA,sBAwCAC,GAxCA,EAwCAL,KAxCA,EAwCA;MAAA;;MACA;QACAK;MADA;MAGAF;QACA;UACA,uCADA,CAEA;;;UACA;QACA,CAJA,MAIA;UACA;QACA;MACA,CARA;IASA,CArDA;IAsDA;IACAG,MAvDA,oBAuDA;MACA;MACA;QACAC;MACA,CAFA;MAGA;IACA;EA7DA,CA9CA;EA6GAC;IACAC;EADA;AA7GA","names":["data","preview_images","computed","domain","props","img_list","type","default","is_multiple","current_num","max_num","size","is_main","created","methods","toFirst","index","uploadFn","file","resource","deleteFile","url","emitFn","image_arr","components","draggable"],"sourceRoot":"src/components","sources":["upload_file.vue"],"sourcesContent":["<template>\n\t<div class=\"image_list\">\n\t\t<draggable\n\t\tstyle=\"display: flex\"\n\t\tv-model=\"preview_images\"\n\t\t@end=\"emitFn\"\n\t\t>\n\t\t<div class=\"view_card_img\" :style=\"{width:`${size}px`,height:`${size}px`,marginRight:`${size/5}px`,marginBottom:`${size/5}px`}\" @mouseenter=\"item.show_icon = true\" @mouseleave=\"item.show_icon = false\" v-for=\"(item,index) in preview_images\" :key=\"index\">\n\t\t\t<div class=\"is_main\" v-if=\"index == 0 && is_main\">主图</div>\n\t\t\t<el-image class=\"card_img\" :src=\"domain + item.urls\" fit=\"scale-down\"></el-image>\n\t\t\t<div class=\"delete_img\" v-if=\"item.show_icon == true\">\n\t\t\t\t<img :style=\"{width:`${size/5}px`,height:`${size/5}px`,cursor: 'pointer'\n\t\t\t}\" src=\"../static/delete_icon.png\" @click=\"deleteFile(item.urls,index)\">\n\t\t\t<div class=\"set_main\" @click=\"toFirst(index)\" v-if=\"index != 0 && is_main\">设为主图</div>\n\t\t</div>\n\t</div>\n</draggable>\n<div class=\"upload_container\" :style=\"{width:`${size}px`,height:`${size}px`}\" v-if=\"preview_images.length < max_num\">\n\t<img :style=\"{width:`${size/4}px`,height:`${size/4}px`}\" src=\"../static/upload_icon.png\">\n\t<div class=\"upload_text\">点击上传</div>\n\t<input type=\"file\" ref=\"imgUpload\" class=\"upload_file\" accept=\"image/*\" :multiple=\"is_multiple\" @change=\"uploadFn\">\n</div>\n</div>\n</template>\n<style lang=\"less\" scoped>\n.image_list {\n\tflex:1;\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\t.view_card_img {\n\t\tborder-radius: 2rem;\n\t\tposition: relative;\n\t\t.is_main{\n\t\t\tbackground:#F37605;\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t\twidth: 36px;\n\t\t\ttext-align: center;\n\t\t\theight: 20px;\n\t\t\tline-height: 20px;\n\t\t\tfont-size: 12px;\n\t\t\tcolor:#ffffff;\n\t\t\tz-index: 9;\n\t\t}\n\t\t.card_img,\n\t\t.delete_img {\n\t\t\tborder-radius: 2rem;\n\t\t\tposition: absolute;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t}\n\t\t.delete_img {\n\t\t\tbackground: rgba(0, 0, 0, 0.4);\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t\t.set_main{\n\t\t\t\tcursor: pointer;\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 0px;\n\t\t\t\tright: 5px;\n\t\t\t\tfont-size: 12px;\n\t\t\t\tfont-weight: bold;\n\t\t\t\tcolor:#ffffff;\n\t\t\t}\n\t\t}\n\t}\n\t.upload_container{\n\t\tborder:1px solid #D9D9D9;\n\t\tborder-radius: 2rem;\n\t\tposition: relative;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content:center;\n\t\talign-items:center;\n\t\tcolor: #666666;\n\t\t.upload_text{\n\t\t\tfont-size: 12px;\n\t\t}\n\t\t.upload_file {\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tbottom: 0;\n\t\t\tleft: 0;\n\t\t\tright: 0;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\topacity: 0;\n\t\t}\n\t}\n}\n</style>\n<script>\n\timport draggable from \"vuedraggable\";\n\n\timport resource from '../api/common_resource.js'\n\texport default{\n\t\tdata(){\n\t\t\treturn{\n\t\t\t\tpreview_images:[],\t\t//当前的图片列表\n\t\t\t}\n\t\t},\n\t\tcomputed:{\n\t\t\t//图片前缀\n\t\t\tdomain(){\n\t\t\t\treturn this.$store.state.domain;\n\t\t\t}\n\t\t},\n\t\tprops:{\n\t\t\timg_list:{\n\t\t\t\ttype:Array,\n\t\t\t\tdefault:[]\n\t\t\t},\n\t\t\t//是否多选\n\t\t\tis_multiple:{\n\t\t\t\ttype:Boolean,\n\t\t\t\tdefault:false\n\t\t\t},\n\t\t\t//多选已上传的数量\n\t\t\tcurrent_num:{\n\t\t\t\ttype:Number,\n\t\t\t\tdefault:0\n\t\t\t},\n\t\t\t//多选最多上传的数量\n\t\t\tmax_num:{\n\t\t\t\ttype:Number,\n\t\t\t\tdefault:1\n\t\t\t},\n\t\t\t//尺寸\n\t\t\tsize:{\n\t\t\t\ttype:Number,\n\t\t\t\tdefault:120\n\t\t\t},\n\t\t\t//是否可以设置主图\n\t\t\tis_main:{\n\t\t\t\ttype:Boolean,\n\t\t\t\tdefault:false\n\t\t\t}\n\t\t},\n\t\tcreated(){\n\t\t\tthis.preview_images = this.img_list;\n\t\t},\n\t\tmethods:{\n\t\t\t//置顶\n\t\t\ttoFirst(index){\n\t\t\t\tthis.preview_images.unshift(this.preview_images.splice(index, 1)[0]);\n\t\t\t\t//向父组件传递已选的图片列表\n\t\t\t\tthis.emitFn();\n\t\t\t\tthis.preview_images[0]['show_icon'] = false;\n\t\t\t},\n\t\t\t// 上传图片\n\t\t\tuploadFn(){\n\t\t\t\tif (this.$refs.imgUpload.files.length > 0) {\n\t\t\t\t\tlet files = this.$refs.imgUpload.files;\n\t\t\t\t\t//判断是否多选\n\t\t\t\t\tif(this.is_multiple == true){\n\t\t\t\t\t\tif(this.current_num + this.$refs.imgUpload.files.length > this.max_num){\n\t\t\t\t\t\t\tthis.$refs.imgUpload.value = null;\n\t\t\t\t\t\t\tthis.$message.warning(`图片最多不超过${this.max_num}张`);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor(var i = 0;i < files.length;i ++){\n\t\t\t\t\t\tlet arg = {\n\t\t\t\t\t\t\tfile:files[i]\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresource.uploadFile(arg).then(res => {\n\t\t\t\t\t\t\tthis.$refs.imgUpload.value = null;\n\t\t\t\t\t\t\tif(res.data.code == 1){\n\t\t\t\t\t\t\t\tlet file = res.data.data;\n\t\t\t\t\t\t\t\tfile.show_icon = false;\n\t\t\t\t\t\t\t\tthis.preview_images.push(file);\n\t\t\t\t\t\t\t\t//向父组件传递已选的图片列表\n\t\t\t\t\t\t\t\tthis.emitFn();\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tthis.$message.warning(res.data.msg);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n    \t\t//删除文件\n    \t\tdeleteFile(url, index) {\n    \t\t\tlet arg = {\n    \t\t\t\turl: url,\n    \t\t\t};\n    \t\t\tresource.delFile(arg).then((res) => {\n    \t\t\t\tif (res.data.code == 1) {\n    \t\t\t\t\tthis.preview_images.splice(index, 1);\n    \t\t\t\t\t//向父组件传递已选的图片列表\n    \t\t\t\t\tthis.emitFn();\n    \t\t\t\t} else {\n    \t\t\t\t\tthis.$message.warning(res.data.msg);\n    \t\t\t\t}\n    \t\t\t});\n    \t\t},\n    \t\t//向父组件传递已选的图片列表\n    \t\temitFn(){\n    \t\t\tlet image_arr = [];\n    \t\t\tthis.preview_images.map(item => {\n    \t\t\t\timage_arr.push(item.urls);\n    \t\t\t})\n    \t\t\tthis.$emit('callbackFn',image_arr);\n    \t\t}\n    \t},\n    \tcomponents:{\n    \t\tdraggable\n    \t}\n    }\n</script>"]}]}