{"remainingRequest":"/Users/fanyulong/project/2022/choose-product/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fanyulong/project/2022/choose-product/src/components/upload_file.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fanyulong/project/2022/choose-product/src/components/upload_file.vue","mtime":1676093282059},{"path":"/Users/fanyulong/project/2022/choose-product/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fanyulong/project/2022/choose-product/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fanyulong/project/2022/choose-product/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/fanyulong/project/2022/choose-product/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fanyulong/project/2022/choose-product/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":["\n\timport resource from '../api/common_resource.js'\n\texport default{\n\t\tdata(){\n\t\t\treturn{\n\t\t\t\tpreview_images:[],\t\t//当前的图片列表\n\t\t\t}\n\t\t},\n\t\tcomputed:{\n\t\t\t//图片前缀\n\t\t\tdomain(){\n\t\t\t\treturn this.$store.state.domain;\n\t\t\t}\n\t\t},\n\t\tprops:{\n\t\t\timg_list:{\n\t\t\t\ttype:Array,\n\t\t\t\tdefault:[]\n\t\t\t},\n\t\t\t//是否多选\n\t\t\tis_multiple:{\n\t\t\t\ttype:Boolean,\n\t\t\t\tdefault:false\n\t\t\t},\n\t\t\t//多选已上传的数量\n\t\t\tcurrent_num:{\n\t\t\t\ttype:Number,\n\t\t\t\tdefault:0\n\t\t\t},\n\t\t\t//多选最多上传的数量\n\t\t\tmax_num:{\n\t\t\t\ttype:Number,\n\t\t\t\tdefault:1\n\t\t\t},\n\t\t\t//尺寸\n\t\t\tsize:{\n\t\t\t\ttype:Number,\n\t\t\t\tdefault:120\n\t\t\t}\n\t\t},\n\t\tcreated(){\n\t\t\tthis.preview_images = this.img_list;\n\t\t},\n\t\tmethods:{\n\t\t\t// 上传图片\n\t\t\tuploadFn(){\n\t\t\t\tif (this.$refs.imgUpload.files.length > 0) {\n\t\t\t\t\tlet files = this.$refs.imgUpload.files;\n\t\t\t\t\t//判断是否多选\n\t\t\t\t\tif(this.is_multiple == true){\n\t\t\t\t\t\tif(this.current_num + this.$refs.imgUpload.files.length > this.max_num){\n\t\t\t\t\t\t\tthis.$refs.imgUpload.value = null;\n\t\t\t\t\t\t\tthis.$message.warning(`图片最多不超过${this.max_num}张`);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor(var i = 0;i < files.length;i ++){\n\t\t\t\t\t\tlet arg = {\n\t\t\t\t\t\t\tfile:files[i]\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresource.uploadFile(arg).then(res => {\n\t\t\t\t\t\t\tthis.$refs.imgUpload.value = null;\n\t\t\t\t\t\t\tif(res.data.code == 1){\n\t\t\t\t\t\t\t\tlet file = res.data.data;\n\t\t\t\t\t\t\t\tfile.show_icon = false;\n\t\t\t\t\t\t\t\tthis.preview_images.push(file);\n\t\t\t\t\t\t\t\t//向父组件传递已选的图片列表\n\t\t\t\t\t\t\t\tthis.emitFn();\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tthis.$message.warning(res.data.msg);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n    \t\t//删除文件\n    \t\tdeleteFile(url, index) {\n    \t\t\tlet arg = {\n    \t\t\t\turl: url,\n    \t\t\t};\n    \t\t\tresource.delFile(arg).then((res) => {\n    \t\t\t\tif (res.data.code == 1) {\n    \t\t\t\t\tthis.preview_images.splice(index, 1);\n    \t\t\t\t\t//向父组件传递已选的图片列表\n    \t\t\t\t\tthis.emitFn();\n    \t\t\t\t} else {\n    \t\t\t\t\tthis.$message.warning(res.data.msg);\n    \t\t\t\t}\n    \t\t\t});\n    \t\t},\n    \t\t//向父组件传递已选的图片列表\n    \t\temitFn(){\n    \t\t\tlet image_arr = [];\n    \t\t\tthis.preview_images.map(item => {\n    \t\t\t\timage_arr.push(item.urls);\n    \t\t\t})\n    \t\t\tthis.$emit('callbackFn',image_arr);\n    \t\t}\n    \t}\n    }\n",{"version":3,"sources":["upload_file.vue"],"names":[],"mappings":";AA+DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"upload_file.vue","sourceRoot":"src/components","sourcesContent":["<template>\n\t<div class=\"image_list\">\n\t\t<div class=\"view_card_img\" :style=\"{width:`${size}px`,height:`${size}px`,marginRight:`${size/5}px`,marginBottom:`${size/5}px`}\" @mouseenter=\"item.show_icon = true\" @mouseleave=\"item.show_icon = false\" v-for=\"(item,index) in preview_images\" :key=\"index\">\n\t\t\t<el-image class=\"card_img\" :src=\"domain + item.urls\" fit=\"scale-down\"></el-image>\n\t\t\t<div class=\"delete_img\" v-if=\"item.show_icon == true\">\n\t\t\t\t<img :style=\"{width:`${size/4}px`,height:`${size/4}px`}\" src=\"../static/delete_icon.png\" @click=\"deleteFile(item.urls,index)\">\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"upload_container\" :style=\"{width:`${size}px`,height:`${size}px`}\" v-if=\"preview_images.length < max_num\">\n\t\t\t<img :style=\"{width:`${size/4}px`,height:`${size/4}px`}\" src=\"../static/upload_icon.png\">\n\t\t\t<div class=\"upload_text\">点击上传</div>\n\t\t\t<input type=\"file\" ref=\"imgUpload\" class=\"upload_file\" accept=\"image/*\" :multiple=\"is_multiple\" @change=\"uploadFn\">\n\t\t</div>\n\t</div>\n</template>\n<style lang=\"less\" scoped>\n.image_list {\n\tflex:1;\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\t.view_card_img {\n\t\tborder-radius: 2rem;\n\t\tposition: relative;\n\t\t.card_img,\n\t\t.delete_img {\n\t\t\tborder-radius: 2rem;\n\t\t\tposition: absolute;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t}\n\t\t.delete_img {\n\t\t\tbackground: rgba(0, 0, 0, 0.4);\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t}\n\t}\n\t.upload_container{\n\t\tborder:1px solid #D9D9D9;\n\t\tborder-radius: 2rem;\n\t\tposition: relative;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content:center;\n\t\talign-items:center;\n\t\tcolor: #666666;\n\t\t.upload_text{\n\t\t\tfont-size: 12px;\n\t\t}\n\t\t.upload_file {\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tbottom: 0;\n\t\t\tleft: 0;\n\t\t\tright: 0;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\topacity: 0;\n\t\t}\n\t}\n}\n</style>\n<script>\n\timport resource from '../api/common_resource.js'\n\texport default{\n\t\tdata(){\n\t\t\treturn{\n\t\t\t\tpreview_images:[],\t\t//当前的图片列表\n\t\t\t}\n\t\t},\n\t\tcomputed:{\n\t\t\t//图片前缀\n\t\t\tdomain(){\n\t\t\t\treturn this.$store.state.domain;\n\t\t\t}\n\t\t},\n\t\tprops:{\n\t\t\timg_list:{\n\t\t\t\ttype:Array,\n\t\t\t\tdefault:[]\n\t\t\t},\n\t\t\t//是否多选\n\t\t\tis_multiple:{\n\t\t\t\ttype:Boolean,\n\t\t\t\tdefault:false\n\t\t\t},\n\t\t\t//多选已上传的数量\n\t\t\tcurrent_num:{\n\t\t\t\ttype:Number,\n\t\t\t\tdefault:0\n\t\t\t},\n\t\t\t//多选最多上传的数量\n\t\t\tmax_num:{\n\t\t\t\ttype:Number,\n\t\t\t\tdefault:1\n\t\t\t},\n\t\t\t//尺寸\n\t\t\tsize:{\n\t\t\t\ttype:Number,\n\t\t\t\tdefault:120\n\t\t\t}\n\t\t},\n\t\tcreated(){\n\t\t\tthis.preview_images = this.img_list;\n\t\t},\n\t\tmethods:{\n\t\t\t// 上传图片\n\t\t\tuploadFn(){\n\t\t\t\tif (this.$refs.imgUpload.files.length > 0) {\n\t\t\t\t\tlet files = this.$refs.imgUpload.files;\n\t\t\t\t\t//判断是否多选\n\t\t\t\t\tif(this.is_multiple == true){\n\t\t\t\t\t\tif(this.current_num + this.$refs.imgUpload.files.length > this.max_num){\n\t\t\t\t\t\t\tthis.$refs.imgUpload.value = null;\n\t\t\t\t\t\t\tthis.$message.warning(`图片最多不超过${this.max_num}张`);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor(var i = 0;i < files.length;i ++){\n\t\t\t\t\t\tlet arg = {\n\t\t\t\t\t\t\tfile:files[i]\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresource.uploadFile(arg).then(res => {\n\t\t\t\t\t\t\tthis.$refs.imgUpload.value = null;\n\t\t\t\t\t\t\tif(res.data.code == 1){\n\t\t\t\t\t\t\t\tlet file = res.data.data;\n\t\t\t\t\t\t\t\tfile.show_icon = false;\n\t\t\t\t\t\t\t\tthis.preview_images.push(file);\n\t\t\t\t\t\t\t\t//向父组件传递已选的图片列表\n\t\t\t\t\t\t\t\tthis.emitFn();\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tthis.$message.warning(res.data.msg);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n    \t\t//删除文件\n    \t\tdeleteFile(url, index) {\n    \t\t\tlet arg = {\n    \t\t\t\turl: url,\n    \t\t\t};\n    \t\t\tresource.delFile(arg).then((res) => {\n    \t\t\t\tif (res.data.code == 1) {\n    \t\t\t\t\tthis.preview_images.splice(index, 1);\n    \t\t\t\t\t//向父组件传递已选的图片列表\n    \t\t\t\t\tthis.emitFn();\n    \t\t\t\t} else {\n    \t\t\t\t\tthis.$message.warning(res.data.msg);\n    \t\t\t\t}\n    \t\t\t});\n    \t\t},\n    \t\t//向父组件传递已选的图片列表\n    \t\temitFn(){\n    \t\t\tlet image_arr = [];\n    \t\t\tthis.preview_images.map(item => {\n    \t\t\t\timage_arr.push(item.urls);\n    \t\t\t})\n    \t\t\tthis.$emit('callbackFn',image_arr);\n    \t\t}\n    \t}\n    }\n</script>"]}]}